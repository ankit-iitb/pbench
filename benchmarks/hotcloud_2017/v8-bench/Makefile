V8=../../v8/
all: bench-native bench-js bench-process js-micro-bench process-microbench

bench-native bench-js bench-process: bench.cc Benchmark.cc Cycles.cc js-micro-bench.cc
	$(V8)/third_party/llvm-build/Release+Asserts/bin/clang++ '-DCR_CLANG_REVISION=296321-1' '-DV8_TARGET_ARCH_X64' '-DENABLE_GDB_JIT_INTERFACE' '-DV8_DEPRECATION_WARNINGS' '-DV8_IMMINENT_DEPRECATION_WARNINGS' '-DV8_I18N_SUPPORT' '-DV8_USE_EXTERNAL_STARTUP_DATA' '-DU_USING_ICU_NAMESPACE=0' '-DU_ENABLE_DYLOAD=0' '-DU_STATIC_IMPLEMENTATION' '-DENABLE_HANDLE_ZAPPING' -I$(V8)/ -I$(V8)/include -I$(V8)/third_party/icu/source/i18n -I$(V8)/third_party/icu/source/common  -Wall -pthread -pedantic -Wmissing-field-initializers -Wno-gnu-zero-variadic-macro-arguments -B$(V8)/third_party/binutils/Linux_x64/Release/bin -Wsign-compare -Wno-undefined-var-template -Wno-nonportable-include-path -B$(V8)/third_party/binutils/Linux_x64/Release/bin --sysroot=/ -m64 -m64 -fdata-sections -ffunction-sections -O3 -fdata-sections -ffunction-sections -O3 -fno-exceptions -fno-rtti -Wall -Wpedantic -std=c++14 -O3 -g -MMD -c -o ./bench-native.o ./bench.cc -DMODE=NATIVE
	$(V8)/third_party/llvm-build/Release+Asserts/bin/clang++ '-DCR_CLANG_REVISION=296321-1' '-DV8_TARGET_ARCH_X64' '-DENABLE_GDB_JIT_INTERFACE' '-DV8_DEPRECATION_WARNINGS' '-DV8_IMMINENT_DEPRECATION_WARNINGS' '-DV8_I18N_SUPPORT' '-DV8_USE_EXTERNAL_STARTUP_DATA' '-DU_USING_ICU_NAMESPACE=0' '-DU_ENABLE_DYLOAD=0' '-DU_STATIC_IMPLEMENTATION' '-DENABLE_HANDLE_ZAPPING' -I$(V8)/ -I$(V8)/include -I$(V8)/third_party/icu/source/i18n -I$(V8)/third_party/icu/source/common  -Wall -pthread -pedantic -Wmissing-field-initializers -Wno-gnu-zero-variadic-macro-arguments -B$(V8)/third_party/binutils/Linux_x64/Release/bin -Wsign-compare -Wno-undefined-var-template -Wno-nonportable-include-path -B$(V8)/third_party/binutils/Linux_x64/Release/bin --sysroot=/ -m64 -m64 -fdata-sections -ffunction-sections -O3 -fdata-sections -ffunction-sections -O3 -fno-exceptions -fno-rtti -Wall -Wpedantic -std=c++14 -O3 -g -MMD -c -o ./bench-js.o ./bench.cc -DMODE=JS
	$(V8)/third_party/llvm-build/Release+Asserts/bin/clang++ '-DCR_CLANG_REVISION=296321-1' '-DV8_TARGET_ARCH_X64' '-DENABLE_GDB_JIT_INTERFACE' '-DV8_DEPRECATION_WARNINGS' '-DV8_IMMINENT_DEPRECATION_WARNINGS' '-DV8_I18N_SUPPORT' '-DV8_USE_EXTERNAL_STARTUP_DATA' '-DU_USING_ICU_NAMESPACE=0' '-DU_ENABLE_DYLOAD=0' '-DU_STATIC_IMPLEMENTATION' '-DENABLE_HANDLE_ZAPPING' -I$(V8)/ -I$(V8)/include -I$(V8)/third_party/icu/source/i18n -I$(V8)/third_party/icu/source/common  -Wall -pthread -pedantic -Wmissing-field-initializers -Wno-gnu-zero-variadic-macro-arguments -B$(V8)/third_party/binutils/Linux_x64/Release/bin -Wsign-compare -Wno-undefined-var-template -Wno-nonportable-include-path -B$(V8)/third_party/binutils/Linux_x64/Release/bin --sysroot=/ -m64 -m64 -fdata-sections -ffunction-sections -O3 -fdata-sections -ffunction-sections -O3 -fno-exceptions -fno-rtti -Wall -Wpedantic -std=c++14 -O3 -g -MMD -c -o ./bench-process.o ./bench.cc -DMODE=PROCESS
	$(V8)/third_party/llvm-build/Release+Asserts/bin/clang++ '-DCR_CLANG_REVISION=296321-1' '-DV8_TARGET_ARCH_X64' '-DENABLE_GDB_JIT_INTERFACE' '-DV8_DEPRECATION_WARNINGS' '-DV8_IMMINENT_DEPRECATION_WARNINGS' '-DV8_I18N_SUPPORT' '-DV8_USE_EXTERNAL_STARTUP_DATA' '-DU_USING_ICU_NAMESPACE=0' '-DU_ENABLE_DYLOAD=0' '-DU_STATIC_IMPLEMENTATION' '-DENABLE_HANDLE_ZAPPING' -I$(V8)/ -I$(V8)/include -I$(V8)/third_party/icu/source/i18n -I$(V8)/third_party/icu/source/common  -Wall -pthread -pedantic -Wmissing-field-initializers -Wno-gnu-zero-variadic-macro-arguments -B$(V8)/third_party/binutils/Linux_x64/Release/bin -Wsign-compare -Wno-undefined-var-template -Wno-nonportable-include-path -B$(V8)/third_party/binutils/Linux_x64/Release/bin --sysroot=/ -m64 -m64 -fdata-sections -ffunction-sections -O3 -fdata-sections -ffunction-sections -O3 -fno-exceptions -fno-rtti -Wall -Wpedantic -std=c++14 -O3 -g -MMD -c -o ./Benchmark.o ./Benchmark.cc
	$(V8)/third_party/llvm-build/Release+Asserts/bin/clang++ '-DCR_CLANG_REVISION=296321-1' '-DV8_TARGET_ARCH_X64' '-DENABLE_GDB_JIT_INTERFACE' '-DV8_DEPRECATION_WARNINGS' '-DV8_IMMINENT_DEPRECATION_WARNINGS' '-DV8_I18N_SUPPORT' '-DV8_USE_EXTERNAL_STARTUP_DATA' '-DU_USING_ICU_NAMESPACE=0' '-DU_ENABLE_DYLOAD=0' '-DU_STATIC_IMPLEMENTATION' '-DENABLE_HANDLE_ZAPPING' -I$(V8)/ -I$(V8)/include -I$(V8)/third_party/icu/source/i18n -I$(V8)/third_party/icu/source/common  -Wall -pthread -pedantic -Wmissing-field-initializers -Wno-gnu-zero-variadic-macro-arguments -B$(V8)/third_party/binutils/Linux_x64/Release/bin -Wsign-compare -Wno-undefined-var-template -Wno-nonportable-include-path -B$(V8)/third_party/binutils/Linux_x64/Release/bin --sysroot=/ -m64 -m64 -fdata-sections -ffunction-sections -O3 -fdata-sections -ffunction-sections -O3 -fno-exceptions -fno-rtti -Wall -Wpedantic -std=c++14 -O3 -g -MMD -c -o ./Cycles.o ./Cycles.cc
	$(V8)/third_party/llvm-build/Release+Asserts/bin/clang++ '-DCR_CLANG_REVISION=296321-1' '-DV8_TARGET_ARCH_X64' '-DENABLE_GDB_JIT_INTERFACE' '-DV8_DEPRECATION_WARNINGS' '-DV8_IMMINENT_DEPRECATION_WARNINGS' '-DV8_I18N_SUPPORT' '-DV8_USE_EXTERNAL_STARTUP_DATA' '-DU_USING_ICU_NAMESPACE=0' '-DU_ENABLE_DYLOAD=0' '-DU_STATIC_IMPLEMENTATION' '-DENABLE_HANDLE_ZAPPING' -I$(V8)/ -I$(V8)/include -I$(V8)/third_party/icu/source/i18n -I$(V8)/third_party/icu/source/common  -Wall -pthread -pedantic -Wmissing-field-initializers -Wno-gnu-zero-variadic-macro-arguments -B$(V8)/third_party/binutils/Linux_x64/Release/bin -Wsign-compare -Wno-undefined-var-template -Wno-nonportable-include-path -B$(V8)/third_party/binutils/Linux_x64/Release/bin --sysroot=/ -m64 -m64 -fdata-sections -ffunction-sections -O3 -fdata-sections -ffunction-sections -O3 -fno-exceptions -fno-rtti -Wall -Wpedantic -std=c++14 -O3 -g -MMD -c -o ./js-micro-bench.o ./js-micro-bench.cc
	$(V8)/third_party/llvm-build/Release+Asserts/bin/clang++ '-DCR_CLANG_REVISION=296321-1' '-DV8_TARGET_ARCH_X64' '-DENABLE_GDB_JIT_INTERFACE' '-DV8_DEPRECATION_WARNINGS' '-DV8_IMMINENT_DEPRECATION_WARNINGS' '-DV8_I18N_SUPPORT' '-DV8_USE_EXTERNAL_STARTUP_DATA' '-DU_USING_ICU_NAMESPACE=0' '-DU_ENABLE_DYLOAD=0' '-DU_STATIC_IMPLEMENTATION' '-DENABLE_HANDLE_ZAPPING' -I$(V8)/ -I$(V8)/include -I$(V8)/third_party/icu/source/i18n -I$(V8)/third_party/icu/source/common  -Wall -pthread -pedantic -Wmissing-field-initializers -Wno-gnu-zero-variadic-macro-arguments -B$(V8)/third_party/binutils/Linux_x64/Release/bin -Wsign-compare -Wno-undefined-var-template -Wno-nonportable-include-path -B$(V8)/third_party/binutils/Linux_x64/Release/bin --sysroot=/ -m64 -m64 -fdata-sections -ffunction-sections -O3 -fdata-sections -ffunction-sections -O3 -fno-exceptions -fno-rtti -Wall -Wpedantic -std=c++14 -O3 -g -MMD -c -o ./process-microbench.o ./process-microbench.cc
	$(V8)/third_party/llvm-build/Release+Asserts/bin/clang++ -B$(V8)/third_party/binutils/Linux_x64/Release/bin -pthread -fuse-ld=gold -B$(V8)/third_party/binutils/Linux_x64/Release/bin -fuse-ld=gold -B$(V8)/third_party/binutils/Linux_x64/Release/bin --sysroot=/ -L/lib/x86_64-linux-gnu -Wl,-rpath-link=/lib/x86_64-linux-gnu -L/usr/lib/x86_64-linux-gnu -Wl,-rpath-link=/usr/lib/x86_64-linux-gnu -L/usr/lib/gcc/x86_64-linux-gnu/4.8 -Wl,-rpath-link=/usr/lib/gcc/x86_64-linux-gnu/4.8 -L/usr/lib -Wl,-rpath-link=/usr/lib -m64 -m64  -o ./bench-native -Wl,--start-group ./bench-native.o ./Benchmark.o ./Cycles.o $(V8)/out/x64.release/obj.target/src/libv8_libbase.a $(V8)/out/x64.release/obj.target/src/libv8_libplatform.a $(V8)/out/x64.release/obj.target/third_party/icu/libicui18n.a $(V8)/out/x64.release/obj.target/third_party/icu/libicuuc.a $(V8)/out/x64.release/obj.target/src/libv8_base.a $(V8)/out/x64.release/obj.target/src/libv8_libsampler.a $(V8)/out/x64.release/obj.target/src/libv8_external_snapshot.a -Wl,--end-group -ldl -lrt
	$(V8)/third_party/llvm-build/Release+Asserts/bin/clang++ -B$(V8)/third_party/binutils/Linux_x64/Release/bin -pthread -fuse-ld=gold -B$(V8)/third_party/binutils/Linux_x64/Release/bin -fuse-ld=gold -B$(V8)/third_party/binutils/Linux_x64/Release/bin --sysroot=/ -L/lib/x86_64-linux-gnu -Wl,-rpath-link=/lib/x86_64-linux-gnu -L/usr/lib/x86_64-linux-gnu -Wl,-rpath-link=/usr/lib/x86_64-linux-gnu -L/usr/lib/gcc/x86_64-linux-gnu/4.8 -Wl,-rpath-link=/usr/lib/gcc/x86_64-linux-gnu/4.8 -L/usr/lib -Wl,-rpath-link=/usr/lib -m64 -m64  -o ./js-micro-bench -Wl,--start-group ./js-micro-bench.o $(V8)/out/x64.release/obj.target/src/libv8_libbase.a $(V8)/out/x64.release/obj.target/src/libv8_libplatform.a $(V8)/out/x64.release/obj.target/third_party/icu/libicui18n.a $(V8)/out/x64.release/obj.target/third_party/icu/libicuuc.a $(V8)/out/x64.release/obj.target/src/libv8_base.a $(V8)/out/x64.release/obj.target/src/libv8_libsampler.a $(V8)/out/x64.release/obj.target/src/libv8_external_snapshot.a -Wl,--end-group -ldl -lrt
	$(V8)/third_party/llvm-build/Release+Asserts/bin/clang++ -B$(V8)/third_party/binutils/Linux_x64/Release/bin -pthread -fuse-ld=gold -B$(V8)/third_party/binutils/Linux_x64/Release/bin -fuse-ld=gold -B$(V8)/third_party/binutils/Linux_x64/Release/bin --sysroot=/ -L/lib/x86_64-linux-gnu -Wl,-rpath-link=/lib/x86_64-linux-gnu -L/usr/lib/x86_64-linux-gnu -Wl,-rpath-link=/usr/lib/x86_64-linux-gnu -L/usr/lib/gcc/x86_64-linux-gnu/4.8 -Wl,-rpath-link=/usr/lib/gcc/x86_64-linux-gnu/4.8 -L/usr/lib -Wl,-rpath-link=/usr/lib -m64 -m64  -o ./bench-js -Wl,--start-group ./bench-js.o ./Benchmark.o ./Cycles.o $(V8)/out/x64.release/obj.target/src/libv8_libbase.a $(V8)/out/x64.release/obj.target/src/libv8_libplatform.a $(V8)/out/x64.release/obj.target/third_party/icu/libicui18n.a $(V8)/out/x64.release/obj.target/third_party/icu/libicuuc.a $(V8)/out/x64.release/obj.target/src/libv8_base.a $(V8)/out/x64.release/obj.target/src/libv8_libsampler.a $(V8)/out/x64.release/obj.target/src/libv8_external_snapshot.a -Wl,--end-group -ldl -lrt
	$(V8)/third_party/llvm-build/Release+Asserts/bin/clang++ -B$(V8)/third_party/binutils/Linux_x64/Release/bin -pthread -fuse-ld=gold -B$(V8)/third_party/binutils/Linux_x64/Release/bin -fuse-ld=gold -B$(V8)/third_party/binutils/Linux_x64/Release/bin --sysroot=/ -L/lib/x86_64-linux-gnu -Wl,-rpath-link=/lib/x86_64-linux-gnu -L/usr/lib/x86_64-linux-gnu -Wl,-rpath-link=/usr/lib/x86_64-linux-gnu -L/usr/lib/gcc/x86_64-linux-gnu/4.8 -Wl,-rpath-link=/usr/lib/gcc/x86_64-linux-gnu/4.8 -L/usr/lib -Wl,-rpath-link=/usr/lib -m64 -m64  -o ./bench-process -Wl,--start-group ./bench-process.o ./Benchmark.o ./Cycles.o $(V8)/out/x64.release/obj.target/src/libv8_libbase.a $(V8)/out/x64.release/obj.target/src/libv8_libplatform.a $(V8)/out/x64.release/obj.target/third_party/icu/libicui18n.a $(V8)/out/x64.release/obj.target/third_party/icu/libicuuc.a $(V8)/out/x64.release/obj.target/src/libv8_base.a $(V8)/out/x64.release/obj.target/src/libv8_libsampler.a $(V8)/out/x64.release/obj.target/src/libv8_external_snapshot.a -Wl,--end-group -ldl -lrt
	$(V8)/third_party/llvm-build/Release+Asserts/bin/clang++ -B$(V8)/third_party/binutils/Linux_x64/Release/bin -pthread -fuse-ld=gold -B$(V8)/third_party/binutils/Linux_x64/Release/bin -fuse-ld=gold -B$(V8)/third_party/binutils/Linux_x64/Release/bin --sysroot=/ -L/lib/x86_64-linux-gnu -Wl,-rpath-link=/lib/x86_64-linux-gnu -L/usr/lib/x86_64-linux-gnu -Wl,-rpath-link=/usr/lib/x86_64-linux-gnu -L/usr/lib/gcc/x86_64-linux-gnu/4.8 -Wl,-rpath-link=/usr/lib/gcc/x86_64-linux-gnu/4.8 -L/usr/lib -Wl,-rpath-link=/usr/lib -m64 -m64  -o ./process-microbench -Wl,--start-group ./process-microbench.o $(V8)/out/x64.release/obj.target/src/libv8_libbase.a $(V8)/out/x64.release/obj.target/src/libv8_libplatform.a $(V8)/out/x64.release/obj.target/third_party/icu/libicui18n.a $(V8)/out/x64.release/obj.target/third_party/icu/libicuuc.a $(V8)/out/x64.release/obj.target/src/libv8_base.a $(V8)/out/x64.release/obj.target/src/libv8_libsampler.a $(V8)/out/x64.release/obj.target/src/libv8_external_snapshot.a -Wl,--end-group -ldl -lrt
#g++ -Wall -Wpedantic -std=c++14 -O3 -g -lpthread -o $@ $^

clean:
	rm -f bench-native bench-js bench-process js-micro-bench process-microbench *.o
